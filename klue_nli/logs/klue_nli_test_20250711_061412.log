./test_logging.sh (test script)
Timestamp: 2025. 07. 11. (금) 06:14:12 UTC
Working Directory: /usr/local/google/home/thekim/github/aimldl/llm_benchmarks_asian_langs/klue_nli
========================================

2025-07-06 18:59:48,058 - INFO - Initialized Vertex AI with project: vertex-workbench-notebook, location: us-central1
2025-07-06 18:59:48,059 - INFO - Initialized model: gemini-2.5-flash
2025-07-06 18:59:48,059 - INFO - Loading KLUE NLI dataset for natural language inference...
2025-07-06 19:00:02,824 - INFO - Preparing to load a subset of 100 samples.
2025-07-06 19:00:02,828 - INFO - Reached sample limit of 100. Halting data loading.
2025-07-06 19:00:02,828 - INFO - ✅ Successfully loaded 100 samples.
2025-07-06 19:00:02,828 - INFO - Starting benchmark...
2025-07-06 19:01:48,002 - ERROR - Prediction failed: Cannot get the response text.
Cannot get the Candidate text.
Response candidate content has no parts (and thus no text). The candidate is likely blocked by the safety filters.
Content:
{
  "role": "model"
}
Candidate:
{
  "content": {
    "role": "model"
  },
  "finish_reason": "MAX_TOKENS"
}
Response:
{
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finish_reason": "MAX_TOKENS"
    }
  ],
  "usage_metadata": {
    "prompt_token_count": 594,
    "total_token_count": 1617,
    "prompt_tokens_details": [
      {
        "modality": "TEXT",
        "token_count": 594
      }
    ],
    "thoughts_token_count": 1023
  },
  "model_version": "gemini-2.5-flash",
  "create_time": "2025-07-06T19:01:40.492285Z",
  "response_id": "FMhqaP2FHqW8nvgP2IrW4As"
}
2025-07-06 19:02:56,717 - ERROR - Prediction failed: Cannot get the response text.
Cannot get the Candidate text.
Response candidate content has no parts (and thus no text). The candidate is likely blocked by the safety filters.
Content:
{
  "role": "model"
}
Candidate:
{
  "content": {
    "role": "model"
  },
  "finish_reason": "MAX_TOKENS"
}
Response:
{
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finish_reason": "MAX_TOKENS"
    }
  ],
  "usage_metadata": {
    "prompt_token_count": 587,
    "total_token_count": 1610,
    "prompt_tokens_details": [
      {
        "modality": "TEXT",
        "token_count": 587
      }
    ],
    "thoughts_token_count": 1023
  },
  "model_version": "gemini-2.5-flash",
  "create_time": "2025-07-06T19:02:48.616287Z",
  "response_id": "WMhqaMPPJaKgnvgPiPGr4AE"
}
Processing samples: 100%|█████████████████████| 100/100 [07:25<00:00,  4.46s/it]
2025-07-06 19:07:28,421 - INFO - Benchmark completed!
2025-07-06 19:07:28,421 - INFO - Accuracy: 0.7500 (75/100)
2025-07-06 19:07:28,421 - INFO - Total time: 445.59 seconds
2025-07-06 19:07:28,421 - INFO - Average time per sample: 4.456 seconds
2025-07-06 19:07:28,421 - INFO - Metrics saved to: benchmark_results/klue_nli_metrics_20250706_190728.json
2025-07-06 19:07:28,423 - INFO - Detailed results saved to: benchmark_results/klue_nli_results_20250706_190728.json
2025-07-06 19:07:28,426 - INFO - Results saved as CSV: benchmark_results/klue_nli_results_20250706_190728.csv

============================================================
KLUE Natural Language Inference Benchmark Results
============================================================
Model: gemini-2.5-flash
Platform: Google Cloud Vertex AI
Project: vertex-workbench-notebook
Location: us-central1
Accuracy: 0.7500 (75/100)
Total Time: 445.59 seconds
Average Time per Sample: 4.456 seconds
Samples per Second: 0.22

Per-label Accuracy:
  contradiction: 0.8000 (16/20)
  entailment: 0.7000 (14/20)
  neutral: 0.7500 (45/60)

Error Analysis (showing first 5 errors):
  1. True: entailment | Predicted: neutral
     Premise: 한국은 아시아에 위치한 국가이다.
     Hypothesis: 한국은 아시아 대륙에 있다.
     Prediction: neutral

  2. True: contradiction | Predicted: entailment
     Premise: 오늘은 비가 온다.
     Hypothesis: 오늘은 맑다.
     Prediction: entailment

  3. True: entailment | Predicted: contradiction
     Premise: 그는 의사이다.
     Hypothesis: 그는 의료진이다.
     Prediction: contradiction

  4. True: neutral | Predicted: entailment
     Premise: 그녀는 학생이다.
     Hypothesis: 그녀는 대학생이다.
     Prediction: entailment

  5. True: contradiction | Predicted: neutral
     Premise: 이 음식은 맛있다.
     Hypothesis: 이 음식은 맛없다.
     Prediction: neutral
